# Facebook Messenger Setup - –°—Ç—ä–ø–∫–∞ –ø–æ —Å—Ç—ä–ø–∫–∞

## üéØ –¶–µ–ª: –ù–∞—Å—Ç—Ä–æ–∏—Ç–µ Rasa –±–æ—Ç–∞ –¥–∞ —Ä–∞–±–æ—Ç–∏ –≤—ä–≤ Facebook Messenger

---

## üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª–Ω–∏ –∏–∑–∏—Å–∫–≤–∞–Ω–∏—è:
- VPS —Å –¥–æ–º–µ–π–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä: your-bot.com)
- Docker –∏–Ω—Å—Ç–∞–ª–∏—Ä–∞–Ω –Ω–∞ VPS
- Facebook –∞–∫–∞—É–Ω—Ç

---

## üöÄ –°—Ç—ä–ø–∫–∞ 1: –°—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ Facebook App

### 1.1 –û—Ç–∏–¥–µ—Ç–µ –Ω–∞ Facebook Developers
- –û—Ç–≤–æ—Ä–µ—Ç–µ: https://developers.facebook.com/
- –í–ª–µ–∑—Ç–µ —Å –≤–∞—à–∏—è Facebook –∞–∫–∞—É–Ω—Ç

### 1.2 –°—ä–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –ö–ª–∏–∫–Ω–µ—Ç–µ "Create App"
- –ò–∑–±–µ—Ä–µ—Ç–µ "Business" —Ç–∏–ø
- –í—ä–≤–µ–¥–µ—Ç–µ –∏–º–µ –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä: "My Rasa Bot")
- –ö–ª–∏–∫–Ω–µ—Ç–µ "Create App"

### 1.3 –î–æ–±–∞–≤–µ—Ç–µ Messenger –ø—Ä–æ–¥—É–∫—Ç
- –í App Dashboard –∫–ª–∏–∫–Ω–µ—Ç–µ "Add Product"
- –ù–∞–º–µ—Ä–µ—Ç–µ "Messenger" –∏ –∫–ª–∏–∫–Ω–µ—Ç–µ "Set Up"

---

## üöÄ –°—Ç—ä–ø–∫–∞ 2: –°—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ Facebook Page

### 2.1 –°—ä–∑–¥–∞–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (–∞–∫–æ –Ω—è–º–∞—Ç–µ)
- –û—Ç–∏–¥–µ—Ç–µ –Ω–∞: https://www.facebook.com/pages/create
- –ò–∑–±–µ—Ä–µ—Ç–µ —Ç–∏–ø —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: "Business or Brand")
- –í—ä–≤–µ–¥–µ—Ç–µ –∏–º–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ç–∞
- –°–ª–µ–¥–≤–∞–π—Ç–µ —Å—Ç—ä–ø–∫–∏—Ç–µ –∑–∞ —Å—ä–∑–¥–∞–≤–∞–Ω–µ

### 2.2 –°–≤—ä—Ä–∂–µ—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ç–∞ —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ
- –í App Dashboard -> Messenger -> Settings
- –í —Å–µ–∫—Ü–∏—è—Ç–∞ "Access Tokens" –∫–ª–∏–∫–Ω–µ—Ç–µ "Add or Remove Pages"
- –ò–∑–±–µ—Ä–µ—Ç–µ –≤–∞—à–∞—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- –ö–ª–∏–∫–Ω–µ—Ç–µ "Add Page"
- **–í–ê–ñ–ù–û**: –ó–∞–ø–∏—à–µ—Ç–µ Page Access Token!

---

## üöÄ –°—Ç—ä–ø–∫–∞ 3: –ù–∞—Å—Ç—Ä–æ–π–≤–∞–Ω–µ –Ω–∞ Webhook

### 3.1 –í Messenger Settings
- –û—Ç–∏–¥–µ—Ç–µ –≤ App Dashboard -> Messenger -> Settings
- –°–∫—Ä–æ–ª–∏—Ä–∞–π—Ç–µ –¥–æ "Webhooks" —Å–µ–∫—Ü–∏—è—Ç–∞
- –ö–ª–∏–∫–Ω–µ—Ç–µ "Add Callback URL"

### 3.2 –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–∞–π—Ç–µ Webhook
- **Callback URL**: `https://your-domain.com/webhooks/facebook/webhook`
- **Verify Token**: `your_secret_token_here` (–∏–∑–º–∏—Å–ª–µ—Ç–µ —Å–ª–æ–∂–µ–Ω —Ç–æ–∫–µ–Ω)
- **Subscription Fields**: –ò–∑–±–µ—Ä–µ—Ç–µ:
  - ‚úÖ `messages`
  - ‚úÖ `messaging_postbacks`
  - ‚úÖ `messaging_optins`
  - ‚úÖ `message_deliveries`
  - ‚úÖ `message_reads`

### 3.3 –ó–∞–ø–∏—à–µ—Ç–µ App Secret
- –í App Dashboard -> Settings -> Basic
- –ó–∞–ø–∏—à–µ—Ç–µ App Secret

---

## üöÄ –°—Ç—ä–ø–∫–∞ 4: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –Ω–∞ VPS

### 4.1 –ö–∞—á–µ—Ç–µ —Ñ–∞–π–ª–æ–≤–µ—Ç–µ
```bash
# –ö–∞—á–µ—Ç–µ facebook_config –ø–∞–ø–∫–∞—Ç–∞ –Ω–∞ –≤–∞—à–∏—è VPS
scp -r facebook_config/ user@your-vps-ip:/home/user/
```

### 4.2 SSH –∫—ä–º VPS
```bash
ssh user@your-vps-ip
cd facebook_config
```

### 4.3 –†–µ–¥–∞–∫—Ç–∏—Ä–∞–π—Ç–µ .env —Ñ–∞–π–ª–∞
```bash
nano .env
```

–î–æ–±–∞–≤–µ—Ç–µ –≤–∞—à–∏—Ç–µ Facebook –¥–∞–Ω–Ω–∏:
```env
# Facebook Messenger Configuration
FACEBOOK_ACCESS_TOKEN=your_page_access_token_here
FACEBOOK_VERIFY_TOKEN=your_verify_token_here
FACEBOOK_SECRET=your_app_secret_here

# Rasa Configuration
RASA_MODEL_PATH=models/20250828-142409-sienna-specter.tar.gz
RASA_PORT=5005
ACTIONS_PORT=5055
```

---

## üöÄ –°—Ç—ä–ø–∫–∞ 5: SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç

### 5.1 –ò–Ω—Å—Ç–∞–ª–∏—Ä–∞–π—Ç–µ Certbot
```bash
sudo apt update
sudo apt install certbot
```

### 5.2 –ü–æ–ª—É—á–µ—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
```bash
sudo certbot certonly --standalone -d your-domain.com
```

### 5.3 –ö–æ–ø–∏—Ä–∞–π—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∏—Ç–µ
```bash
sudo cp /etc/letsencrypt/live/your-domain.com/fullchain.pem ./ssl/
sudo cp /etc/letsencrypt/live/your-domain.com/privkey.pem ./ssl/
sudo chown $USER:$USER ./ssl/*
```

---

## üöÄ –°—Ç—ä–ø–∫–∞ 6: –°—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –±–æ—Ç–∞

### 6.1 –°—Ç–∞—Ä—Ç–∏—Ä–∞–π—Ç–µ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏—Ç–µ
```bash
docker-compose up -d
```

### 6.2 –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ —Å—Ç–∞—Ç—É—Å–∞
```bash
docker-compose ps
docker-compose logs rasa
```

---

## üöÄ –°—Ç—ä–ø–∫–∞ 7: –¢–µ—Å—Ç–≤–∞–Ω–µ

### 7.1 –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ webhook
```bash
curl -X GET "https://your-domain.com/webhooks/facebook/webhook?hub.mode=subscribe&hub.challenge=test&hub.verify_token=your_verify_token"
```

### 7.2 –¢–µ—Å—Ç–≤–∞–π—Ç–µ –≤ Facebook
- –û—Ç–∏–¥–µ—Ç–µ –Ω–∞ –≤–∞—à–∞—Ç–∞ Facebook —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- –ö–ª–∏–∫–Ω–µ—Ç–µ "Message"
- –ò–∑–ø—Ä–∞—Ç–µ—Ç–µ —Å—ä–æ–±—â–µ–Ω–∏–µ "Hello"
- –ë–æ—Ç—ä—Ç —Ç—Ä—è–±–≤–∞ –¥–∞ –æ—Ç–≥–æ–≤–æ—Ä–∏!

---

## üîß Troubleshooting

### –ü—Ä–æ–±–ª–µ–º: Webhook –Ω–µ —Ä–∞–±–æ—Ç–∏
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –¥–∞–ª–∏ –¥–æ–º–µ–π–Ω—ä—Ç —Å–æ—á–∏ –∫—ä–º VPS
2. –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –¥–∞–ª–∏ –ø–æ—Ä—Ç 443 –µ –æ—Ç–≤–æ—Ä–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

### –ü—Ä–æ–±–ª–µ–º: –ë–æ—Ç—ä—Ç –Ω–µ –æ—Ç–≥–æ–≤–∞—Ä—è
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –ª–æ–≥–æ–≤–µ—Ç–µ: `docker-compose logs rasa`
2. –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –¥–∞–ª–∏ —Ç–æ–∫–µ–Ω–∏—Ç–µ —Å–∞ –ø—Ä–∞–≤–∏–ª–Ω–∏
3. –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –¥–∞–ª–∏ webhook URL –µ –ø—Ä–∞–≤–∏–ª–µ–Ω

### –ü—Ä–æ–±–ª–µ–º: SSL –≥—Ä–µ—à–∫–∞
**–†–µ—à–µ–Ω–∏–µ:**
1. –û–±–Ω–æ–≤–µ—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞: `sudo certbot renew`
2. –ö–æ–ø–∏—Ä–∞–π—Ç–µ –Ω–æ–≤–∏—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∏
3. –†–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞–π—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏—Ç–µ

---

## üìû –ü–æ–¥–¥—Ä—ä–∂–∫–∞

–ó–∞ –ø—Ä–æ–±–ª–µ–º–∏:
1. –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –ª–æ–≥–æ–≤–µ—Ç–µ: `docker-compose logs`
2. –¢–µ—Å—Ç–≤–∞–π—Ç–µ webhook URL
3. –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ Facebook App –Ω–∞—Å—Ç—Ä–æ–π–∫–∏—Ç–µ
4. –£–≤–µ—Ä–µ—Ç–µ —Å–µ, —á–µ –¥–æ–º–µ–π–Ω—ä—Ç —Ä–∞–±–æ—Ç–∏

---

## ‚úÖ –£—Å–ø–µ—à–Ω–æ –Ω–∞—Å—Ç—Ä–æ–π–≤–∞–Ω–µ!

–°–ª–µ–¥ —Ç–µ–∑–∏ —Å—Ç—ä–ø–∫–∏ –≤–∞—à–∏—è—Ç Rasa –±–æ—Ç —â–µ —Ä–∞–±–æ—Ç–∏ –≤—ä–≤ Facebook Messenger! üéâ
